"0","## 此函數可以把學年學期標上對應第幾學期的學次數字"
"0","semesterNumber<-function(xx){"
"0","  xx %>% as.factor ->xx"
"0","  levels(xx) <- 1:length(levels(xx))"
"0","  as.integer(xx)"
"0","} "
"2","Warning message:
"
"2","In strsplit(code, ""\n"", fixed = TRUE) :"
"2","
 "
"2"," input string 1 is invalid in this locale
"
"0","transcriptData %>%"
"0","  mutate("
"0","    學年學期=str_c(學年,""-"",學期)"
"0","  ) %>%"
"0","  group_by(學號) %>%"
"0","  mutate("
"0","    第幾學期=semesterNumber(學年學期)"
"0","  ) -> transcriptDataWithSemesterCounts ## 到此，每個學生的每個學期是第幾學期就都有了"
"0","transcriptDataWithSemesterCounts %>%"
"0","  group_by(學號) %>%"
"0","  mutate(最大學期=max(第幾學期)) %>%"
"0","  ungroup %>%"
"0","  filter(最大學期>=8, 第幾學期<=8) -> "
"0","  filteredTranscriptData"
"0","filteredTranscriptData %>%"
"0","  group_by(學號) %>%"
"0","  summarise("
"0","    學系=學系[1],"
"0","    學屆=學屆[1],"
"0","    學屆平均成績=sum(學期成績*學分數)/sum(學分數)"
"0","  ) %>% "
"0","  ungroup -> grade4Years"
"0","grade4Years %>%"
"0","  group_by(學系,學屆) %>%"
"0","  mutate("
"0","    學屆PR=percent_rank(學屆平均成績)*100"
"0","  ) -> grade4Years"
"0","grade4Years"
